# 无人机重量计算器 - 测试用例

## 测试目标
验证所有核心功能的正确性：
- ✅ 加减项目时总重量计算
- ✅ 启用/禁用项目时过滤正确
- ✅ 推重比计算
- ✅ 目标比较
- ✅ 导出 TXT
- ✅ 导出/导入 JSON

---

## 测试前准备

1. 打开 `index.html` 在浏览器中
2. 打开浏览器开发者工具（F12），查看 Console
3. 建议先清空 localStorage：在 Console 输入 `localStorage.clear()` 然后刷新页面

---

## 测试用例 1：基础计算验证

### 1.1 初始状态检查
**操作：**
- 刷新页面，查看初始加载的示例数据

**预期结果：**
- ✅ 项目名称：F550-RTK-Flash-v1
- ✅ 电机数量下拉框显示：Hexa (6)（不是 Quad）
- ✅ 右侧汇总面板显示总重量
- ✅ 每电机负载 = 总重量(kg) / 6

**验证点：**
```
检查 "Weight per Motor" 是否 = Total Weight (kg) / 6
```

---

### 1.2 添加单个项目
**操作：**
1. 点击 "+ Add Item"
2. 填写：
   - Name: Test Item
   - Category: Misc
   - Quantity: 2
   - Unit Weight: 100 g
   - Notes: (留空)
3. 点击 "Save"

**预期结果：**
- ✅ 表格中新增一行
- ✅ 该行显示：Qty=2, Unit=100, Total=200
- ✅ 右侧总重量增加 200g
- ✅ 每电机负载相应更新

**验证计算：**
```
新总重量 = 原总重量 + (2 × 100) = 原总重量 + 200g
```

---

### 1.3 编辑项目
**操作：**
1. 找到刚添加的 "Test Item"
2. 点击 "Edit"
3. 修改 Quantity: 2 → 5
4. 点击 "Save"

**预期结果：**
- ✅ 该行 Total 变为 500g (5 × 100)
- ✅ 总重量增加 300g (500 - 200)
- ✅ 汇总实时更新

**验证计算：**
```
新总重量 = 原总重量 - 200 + 500 = 原总重量 + 300g
```

---

### 1.4 删除项目
**操作：**
1. 找到 "Test Item"
2. 点击 "Delete"
3. 确认删除

**预期结果：**
- ✅ 该行从表格消失
- ✅ 总重量减少 500g
- ✅ 汇总实时更新

**验证计算：**
```
新总重量 = 原总重量 - 500g
```

---

## 测试用例 2：启用/禁用功能

### 2.1 禁用单个项目
**操作：**
1. 找到任意一个已启用（✓）的项目
2. 取消勾选该项目的复选框

**预期结果：**
- ✅ 该项目的 Total 不再计入总重量
- ✅ 右侧汇总立即更新
- ✅ 分类统计中该分类的重量减少

**验证计算：**
```
新总重量 = 原总重量 - 被禁用项目的 Total
```

---

### 2.2 重新启用项目
**操作：**
1. 重新勾选刚才禁用的项目

**预期结果：**
- ✅ 总重量恢复
- ✅ 所有计算回到禁用前的状态

---

### 2.3 批量禁用测试
**操作：**
1. 禁用所有 "Payload" 分类的项目
2. 观察总重量变化

**预期结果：**
- ✅ 总重量减少所有 Payload 项目的总和
- ✅ 分类统计中 Payload 显示为 0 或消失
- ✅ 每电机负载相应减少

---

## 测试用例 3：推重比计算

### 3.1 设置电机推力
**操作：**
1. 在 "Motor Max Thrust (g)" 输入：1400
2. 确认电机数量为 6

**预期结果：**
- ✅ 右侧出现 "Thrust-to-Weight Ratio" 卡片
- ✅ 显示推重比数值
- ✅ 显示状态指示器（绿色/黄色/红色）

**验证计算：**
```
总推力 = 1400 × 6 = 8400 g
推重比 = 8400 / 当前总重量(g)
```

**状态判断：**
- T/W ≥ 3.0 → 绿色 "✓ Safe"
- 2.5 ≤ T/W < 3.0 → 黄色 "⚠ Warning"
- T/W < 2.5 → 红色 "✗ Low"

---

### 3.2 修改推力值
**操作：**
1. 将 "Motor Max Thrust" 改为 2000
2. 观察推重比变化

**预期结果：**
- ✅ 推重比数值增加
- ✅ 状态指示器可能改变颜色
- ✅ "Total thrust" 显示：12000 g (2000 × 6)

---

### 3.3 修改电机数量
**操作：**
1. 将电机数量改为 4 (Quad)
2. 观察推重比变化

**预期结果：**
- ✅ 总推力 = 2000 × 4 = 8000 g
- ✅ 推重比重新计算
- ✅ 每电机负载 = 总重量(kg) / 4

---

## 测试用例 4：目标比较功能

### 4.1 设置目标 AUW
**操作：**
1. 在 "Target AUW (g)" 输入：2500
2. 观察右侧 "Target Comparison" 卡片

**预期结果：**
- ✅ 显示 "Target Comparison" 卡片
- ✅ 显示目标 AUW: 2500 g
- ✅ 显示差值（当前总重量 - 2500）
- ✅ 如果超重显示红色，未超重显示绿色

---

### 4.2 设置目标推重比
**操作：**
1. 在 "Target T/W Ratio" 输入：3.0
2. 确保已设置电机推力

**预期结果：**
- ✅ "Target Comparison" 卡片显示目标 T/W: 3.0
- ✅ 显示当前 T/W 和差值
- ✅ 如果低于目标显示红色，高于目标显示绿色

---

### 4.3 同时设置两个目标
**操作：**
1. 同时设置 Target AUW 和 Target T/W
2. 添加/删除项目，观察两个目标的变化

**预期结果：**
- ✅ 两个目标都显示
- ✅ 实时更新差值
- ✅ 颜色正确反映是否达标

---

## 测试用例 5：分类统计

### 5.1 验证分类汇总
**操作：**
1. 查看右侧 "By Category" 列表
2. 手动计算每个分类的总和

**预期结果：**
- ✅ 每个分类显示该分类下所有**已启用**项目的总重量
- ✅ 分类按重量从大到小排序
- ✅ 总和 = 右侧显示的总重量

**验证方法：**
```
手动计算：
Frame 总重 = Σ(所有 Frame 项目的 qty × weightPerUnit)
Motor 总重 = Σ(所有 Motor 项目的 qty × weightPerUnit)
...
所有分类总和 = 总重量
```

---

### 5.2 禁用分类中的部分项目
**操作：**
1. 找到某个分类有多个项目（如 Motor）
2. 禁用其中一个项目
3. 观察分类统计

**预期结果：**
- ✅ 该分类的总重减少被禁用项目的重量
- ✅ 总重量相应减少
- ✅ 其他分类不受影响

---

## 测试用例 6：场景管理

### 6.1 保存场景
**操作：**
1. 配置好当前的项目列表（启用/禁用状态）
2. 点击 "Save Current Scenario"
3. 输入场景名：With Flash
4. 确认保存

**预期结果：**
- ✅ 弹出提示 "Scenario 'With Flash' saved!"
- ✅ 下拉框出现 "With Flash" 选项

---

### 6.2 修改后保存新场景
**操作：**
1. 禁用所有 Payload 项目
2. 保存为新场景：Without Flash

**预期结果：**
- ✅ 两个场景都在下拉框中
- ✅ 可以切换场景

---

### 6.3 加载场景
**操作：**
1. 从下拉框选择 "With Flash"

**预期结果：**
- ✅ 所有项目的启用/禁用状态恢复到保存时的状态
- ✅ 总重量恢复到该场景的值
- ✅ 所有计算更新

---

### 6.4 删除场景
**操作：**
1. 选择 "Without Flash"
2. 点击 "Delete"
3. 确认删除

**预期结果：**
- ✅ 场景从下拉框消失
- ✅ 当前显示的场景不受影响

---

## 测试用例 7：导出 TXT

### 7.1 基础导出
**操作：**
1. 配置好项目（有多个分类的项目）
2. 点击 "Export TXT"
3. 打开下载的 .txt 文件

**预期结果：**
- ✅ 文件包含项目名称、描述、电机数量
- ✅ 包含总重量、每电机负载
- ✅ 包含分类统计
- ✅ 包含所有已启用项目的详细信息
- ✅ 如果设置了推力，包含推重比信息

**验证内容：**
```
检查文件内容：
1. Project Name 是否正确
2. Total Weight (g) 是否与页面显示一致
3. Weight per motor 是否 = Total Weight (kg) / rotorCount
4. By Category 总和是否 = Total Weight
5. Items 列表是否只包含已启用的项目
6. 推重比计算是否正确（如果设置了）
```

---

### 7.2 导出时禁用部分项目
**操作：**
1. 禁用几个项目
2. 导出 TXT

**预期结果：**
- ✅ 导出的文件只包含已启用项目
- ✅ 总重量和分类统计与页面显示一致

---

## 测试用例 8：JSON 导出/导入

### 8.1 导出 JSON
**操作：**
1. 配置好项目、场景
2. 点击 "Export JSON"
3. 打开下载的 .json 文件

**预期结果：**
- ✅ JSON 格式正确
- ✅ 包含 project、items、scenarios
- ✅ 所有数据完整

**验证内容：**
```json
{
  "project": {
    "name": "...",
    "rotorCount": 6,
    "targetAUW": ...,
    "targetTW": ...,
    "motorThrust": ...
  },
  "items": [...],
  "scenarios": {...},
  "exportDate": "..."
}
```

---

### 8.2 导入 JSON
**操作：**
1. 修改一些数据
2. 点击 "Import JSON"
3. 选择刚才导出的 JSON 文件

**预期结果：**
- ✅ 所有数据恢复到导出时的状态
- ✅ 项目名称、设置都恢复
- ✅ 所有项目列表恢复
- ✅ 场景列表恢复
- ✅ UI 状态同步（电机数量下拉框等）

---

### 8.3 导入后验证计算
**操作：**
1. 导入 JSON 后
2. 检查所有计算是否正确

**预期结果：**
- ✅ 总重量正确
- ✅ 分类统计正确
- ✅ 推重比正确（如果设置了）
- ✅ 目标比较正确

---

## 测试用例 9：边界情况

### 9.1 空项目列表
**操作：**
1. 删除所有项目
2. 或点击 "Clear All"

**预期结果：**
- ✅ 总重量显示 0 g
- ✅ 每电机负载显示 0.000 kg
- ✅ 分类统计为空
- ✅ 推重比不显示（或显示 N/A）

---

### 9.2 所有项目禁用
**操作：**
1. 取消所有项目的勾选

**预期结果：**
- ✅ 总重量 = 0
- ✅ 分类统计为空或全为 0
- ✅ 导出 TXT 时只包含已启用项目（即空列表）

---

### 9.3 极大数值
**操作：**
1. 添加一个项目：Qty=1000, Weight=1000g

**预期结果：**
- ✅ 总重量正确计算：1,000,000 g = 1000 kg
- ✅ 每电机负载正确
- ✅ 推重比正确（如果设置了）

---

### 9.4 小数重量
**操作：**
1. 添加项目：Weight=0.5g

**预期结果：**
- ✅ 总重量精确到小数点
- ✅ 显示正确（如 0.50 g）

---

### 9.5 电机数量为 0
**操作：**
1. 设置自定义电机数量为 0（如果允许）

**预期结果：**
- ✅ 每电机负载显示合理值（如 0 或 N/A）
- ✅ 推重比计算正确处理（避免除以 0）

---

## 测试用例 10：数据持久化

### 10.1 刷新页面
**操作：**
1. 配置好项目
2. 刷新页面（F5）

**预期结果：**
- ✅ 所有数据保留
- ✅ 项目列表恢复
- ✅ 场景列表恢复
- ✅ 所有设置恢复

---

### 10.2 关闭浏览器重开
**操作：**
1. 配置好项目
2. 关闭浏览器
3. 重新打开页面

**预期结果：**
- ✅ 数据仍然保留（localStorage）

---

## 测试用例 11：UI 交互

### 11.1 电机数量切换
**操作：**
1. 在电机数量下拉框切换：Quad → Hexa → Octo
2. 观察每电机负载变化

**预期结果：**
- ✅ 每电机负载 = 总重量(kg) / 新电机数量
- ✅ 推重比重新计算（如果设置了）

---

### 11.2 自定义电机数量
**操作：**
1. 选择 "Custom"
2. 输入自定义数量：10

**预期结果：**
- ✅ 自定义输入框显示
- ✅ 每电机负载 = 总重量(kg) / 10
- ✅ 推重比 = 总推力 / 总重量（推力 × 10）

---

## 测试报告模板

完成测试后，记录结果：

```
测试日期：___________
测试人员：___________

测试用例 | 状态 | 备注
---------|------|------
1.1 初始状态 | ✅/❌ | 
1.2 添加项目 | ✅/❌ |
1.3 编辑项目 | ✅/❌ |
1.4 删除项目 | ✅/❌ |
2.1 禁用项目 | ✅/❌ |
2.2 重新启用 | ✅/❌ |
2.3 批量禁用 | ✅/❌ |
3.1 设置推力 | ✅/❌ |
3.2 修改推力 | ✅/❌ |
3.3 修改电机数 | ✅/❌ |
4.1 目标AUW | ✅/❌ |
4.2 目标T/W | ✅/❌ |
4.3 双目标 | ✅/❌ |
5.1 分类统计 | ✅/❌ |
5.2 部分禁用 | ✅/❌ |
6.1 保存场景 | ✅/❌ |
6.2 多场景 | ✅/❌ |
6.3 加载场景 | ✅/❌ |
6.4 删除场景 | ✅/❌ |
7.1 导出TXT | ✅/❌ |
7.2 导出过滤 | ✅/❌ |
8.1 导出JSON | ✅/❌ |
8.2 导入JSON | ✅/❌ |
8.3 导入验证 | ✅/❌ |
9.1 空列表 | ✅/❌ |
9.2 全禁用 | ✅/❌ |
9.3 大数值 | ✅/❌ |
9.4 小数 | ✅/❌ |
9.5 零电机 | ✅/❌ |
10.1 刷新 | ✅/❌ |
10.2 重开 | ✅/❌ |
11.1 切换电机 | ✅/❌ |
11.2 自定义 | ✅/❌ |

发现的问题：
1. 
2. 
3. 
```

---

## 快速测试清单（5分钟）

如果时间有限，优先测试这些：

1. ✅ 添加项目 → 总重量增加
2. ✅ 禁用项目 → 总重量减少
3. ✅ 设置推力 → 推重比显示
4. ✅ 导出 TXT → 文件内容正确
5. ✅ 导入 JSON → 数据恢复
6. ✅ 保存场景 → 可以加载

---

## 常见问题排查

### 问题：总重量计算不对
**检查：**
- 是否只计算了已启用项目？
- 是否使用了 qty × weightPerUnit？
- 分类统计总和是否等于总重量？

### 问题：推重比不显示
**检查：**
- 是否设置了 motorThrust？
- 是否设置了 rotorCount > 0？
- 总重量是否 > 0？

### 问题：场景加载后数据不对
**检查：**
- 场景保存时是否保存了 enabled 状态？
- 加载时是否恢复了所有项目的状态？

### 问题：导出 TXT 格式不对
**检查：**
- 是否只包含已启用项目？
- 数值格式是否正确（保留小数）？
- 分类分组是否正确？

